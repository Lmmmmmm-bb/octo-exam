import{d as B,o as y,n as E,p as w,f as C,e as $,s as A,ab as U,a6 as z,u as e,c as V,w as d,a as o,aD as u,aE as j,Q as D,H as I,I as k,aF as M,a7 as N,W as P,C as q,a8 as H,ae as K,M as O,N as W}from"./vendor.2a757ea6.js";/* empty css                *//* empty css              *//* empty css              *//* empty css               *//* empty css                    *//* empty css                */import{_ as Q}from"./index.dcbd8613.js";import{w as G,_ as R,a as J}from"./index.207fd086.js";/* empty css                 *//* empty css            *//* empty css                *//* empty css               */import{u as F}from"./useToggle.150cc056.js";import{u as L}from"./useLocale.3fe9dc1b.js";import{h as v,R as X}from"./index.007ccf8f.js";import{_ as Y}from"./index.5fc35f6c.js";import{r as Z}from"./refresh.ffce9b94.js";import{_ as ee}from"./plugin-vue_export-helper.1c6f6f40.js";/* empty css               */const te=B({name:"Search"}),oe={viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},ae=w("path",{fill:"currentColor",d:"m795.904 750.72 124.992 124.928a32 32 0 0 1-45.248 45.248L750.656 795.904a416 416 0 1 1 45.248-45.248zM480 832a352 352 0 1 0 0-704 352 352 0 0 0 0 704z"},null,-1),ne=[ae];function re(x,s,r,a,f,g){return y(),E("svg",oe,ne)}var se=ee(te,[["render",re]]);const ce="/score",le="/scores",T="/score",ie=`${ce}/exam`,pe={class:"w-full flex justify-center items-center flex-col"},me=B({props:{isHidePagination:{type:Boolean}},setup(x,{expose:s}){const r=x,{t:a}=L(),f=C([]),{isActive:g,onToggle:c}=F(),l=$({total:0,data:[]}),i=$({current:1,pageSize:10}),m=async()=>{try{c();const{data:t}=await v.getRequest(le,{params:{page:i.current,pageSize:i.pageSize}}),{list:n,total:b}=t;l.data=n,l.total=b}catch{}finally{c()}},S=async t=>{try{c();const{data:n}=await v.getRequest(`${ie}/${t}`);l.data=n,l.total=n.length}catch{}finally{c()}},_=t=>f.value=t,p=async t=>{try{await v.deleteRequest(T,{params:{list:t.scoreId}}),await m()}catch{}return!0};return s({selectedRows:f,onFetchScore:m,onFetchScoreByExamCode:S}),A(()=>{m()}),(t,n)=>{const b=U("loading");return y(),E("div",pe,[z((y(),V(e(M),{"empty-text":e(a)("score.empty"),size:"large","row-key":"scoreId",data:e(l).data,"highlight-current-row":"",onSelectionChange:_},{default:d(()=>[o(e(u),{type:"selection",width:"50",align:"center"}),o(e(u),{label:e(a)("profile.studentId"),prop:"studentId"},null,8,["label"]),o(e(u),{label:e(a)("exam.code"),prop:"examCode"},null,8,["label"]),o(e(u),{label:e(a)("score.subject"),prop:"subject"},null,8,["label"]),o(e(u),{label:e(a)("score.score"),prop:"score"},null,8,["label"]),o(e(u),{label:e(a)("score.date"),prop:"answerDate"},null,8,["label"]),o(e(u),{label:e(a)("common.operate")},{default:d(h=>[o(e(j),{icon:e(G),"icon-color":"red",title:e(a)("score.deleteComfirm"),"confirm-button-text":e(a)("common.confirm"),"cancel-button-text":e(a)("common.cancel"),onConfirm:fe=>p(h.row)},{reference:d(()=>[o(e(D),{size:"small",type:"danger",plain:""},{default:d(()=>[I(k(e(a)("common.delete")),1)]),_:1})]),_:2},1032,["icon","title","confirm-button-text","cancel-button-text","onConfirm"])]),_:1},8,["label"])]),_:1},8,["empty-text","data"])),[[b,e(g)]]),z(o(Y,{"current-page":e(i).current,"onUpdate:current-page":n[0]||(n[0]=h=>e(i).current=h),"page-size":e(i).pageSize,"onUpdate:page-size":n[1]||(n[1]=h=>e(i).pageSize=h),class:"mt-4",total:e(l).total,onPageChange:m},null,8,["current-page","page-size","total"]),[[N,r.isHidePagination]])])}}}),ue={class:"outerWrapper"},de={class:"w-full flex justify-between mb-2"},Te=B({setup(x){const{t:s}=L(),r=C(),{isActive:a,onActive:f,onUnActive:g}=F(),c=C(""),l=P(()=>r.value?r.value.selectedRows.length===0:!0),i=()=>{g(),r.value&&r.value.onFetchScore()},m=()=>{if(r.value){const{onFetchScore:p,onFetchScoreByExamCode:t}=r.value;c.value.trim().length===0?p():(f(),t(c.value))}},S=async()=>{if(r.value){const p=r.value.selectedRows;K.confirm(s("exam.deleteConfirm"),s("common.tip"),{cancelButtonText:s("common.cancel"),confirmButtonText:s("common.confirm")}).then(async()=>{const t=p.map(n=>n.scoreId.toString());await v.deleteRequest(T,{params:{list:t.join(",")}}),_()})}},_=()=>{if(r.value){const{onFetchScore:p,onFetchScoreByExamCode:t}=r.value;a.value?t(c.value):p()}};return(p,t)=>(y(),E("div",ue,[o(Q,{path:[{text:e(s)(`menu.${e(X).ScoreManage}`)}]},null,8,["path"]),o(e(q)),w("div",de,[o(e(H),{size:"large"},{default:d(()=>[o(e(O),{modelValue:c.value,"onUpdate:modelValue":t[0]||(t[0]=n=>c.value=n),placeholder:e(s)("score.searchByCode"),clearable:"",onClear:i,onKeyup:W(m,["enter"])},null,8,["modelValue","placeholder","onKeyup"]),o(e(D),{type:"primary",icon:e(se),onClick:m},{default:d(()=>[I(k(e(s)("common.search")),1)]),_:1},8,["icon"])]),_:1}),w("div",null,[o(R,{icon:e(J),disabled:e(l),type:"danger",content:e(s)("common.delete"),onOnClick:S},null,8,["icon","disabled","content"]),o(R,{icon:e(Z),type:"primary",content:e(s)("common.refresh"),onOnClick:_},null,8,["icon","content"])])]),o(me,{ref_key:"tableRef",ref:r,"is-hide-pagination":!e(a)},null,8,["is-hide-pagination"])]))}});export{Te as default};
